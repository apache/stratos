<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1"></meta>
  <title>Access Throttling - User Guide</title>
  <link href="../../admin/css/documentation.css" rel="stylesheet" type="text/css" media="all" />
  </head>

<body>
<h1>Access Throttling</h1>

<p>In Web service interactions, we usually have to restrict the number of
requests that the web service serves for a particular client. The throttle
mechanism is used to control access to our services at different levels.</p>

<p>The WSO2 Web service Application Server (WSAS) provides an effective and
efficient way to apply the throttle mechanism to your Web services.</p>

<p></p>

<h2>Levels of Throttling</h2>

<p>Throttling can be enabled at global level, service level or operation
level. </p>
<ol>
</ol>
<ul>
  <li>If it is enabled globally, restrictions are applied globally (for every
    message coming into the server).</li>
  <li>If it is enabled for a particular service, restrictions are applied to
    all the messages coming into that service. </li>
  <li>If it is enabled only for an operation in a given service, restrictions
    are applied only for the messages accessing that particular
  operation.</li>
</ul>
<ol>
</ol>

<p>The WSO2 WSAS provides the throttling mechanism at global level or service
level.</p>

<h2>Adding Throttling to a Service</h2>

<p>Use this function to add a throttle parameter that specifies a variable
millisecond wait between calls or a variable maximum number of calls per unit
of time. This would facilitate the smooth operation of Web services and REST
using the Web service and HTTP client steps.</p>

<p>The throttling option is disabled by default. If you want to add the
throttling mechanism, you should enable it. </p>
<ol>
  <li>In the navigator, under Manage/Service, click <strong>List</strong>.
    The <em><strong>Deployed Services</strong></em> page appears.</li>
  <li>Select the service for which you want to enable throttling. The
    <em><strong>Service Dashboard</strong></em> page (for that service)
    appears.</li>
  <li>In the Quality of Service Configuration panel, click <strong>Access
    Throttling</strong>. The <em><strong>Throttling
    Configuration</strong></em> page appears.</li>
  <li>In the <strong>Enable Throttling</strong> list, click
    <strong>Yes</strong>.The existing throttle configuration appears in the
    wizard </li>

  <p><img alt="" src="images/throttle.jpg" height="393" width="1401"/></p>

  <p>Figure 1: Throttling Configuration</p>
  <li>Click <strong>Add New Entry</strong>. To enter new parameters or modify
    existing parameters click <strong>Allow</strong> in the
    <strong>Access</strong> list. </li>

  <p>If you set the parameters for a particular service, your configuration
  will be applied only to that particular service. On the other hand, if you
  reached this page from global configurations, these configurations will be
  applied globally.</p>
  <li>Click <strong>Finish</strong>. Throttling will be engaged for that
    particular service or it will be engaged globally.</li>
</ol>

<p style="margin-left: 40px;"><a href="#Fields">Field Descriptions</a></p>

<p></p>

<h2>Functions of Buttons</h2>

<ul>
    <li><strong>Finish :</strong> Click Finish to submit the current data.
        When finished, your throttle configuration will be applied and the page will be
        redirected to the previous page.</li>
    <li><strong>Reset :</strong> Click Reset to load the last submitted configuration.</li>
    <li><strong>Default :</strong> Click Default to load the default throttle
        configuration. If you want to submit those data, you have to click Finish.</li>
    <li><strong>Clear :</strong> Click Clear to clear all the text boxes in the UI.</li>
    <li><strong>Back :</strong> Click Back to go to the previous page.</li>
</ul>

<h2>Parameters for Throttling Configuration</h2>

<h4><a name="Fields" id="Fields">Fields</a></h4>

<table style="width: 100%;" border="1">
  <caption></caption>
  <tbody>
    <tr>
      <td style="font-weight: bold;">Field Name</td>
      <td style="font-weight: bold;">Description</td>
    </tr>
    <tr>
      <td>Maximum Concurrent Accesses</td>
      <td>It can be used to control the number of requests that are served at
        any given moment. If throttling is enabled globally, this value will
        be the maximum number of requests that are served by all the services
        deployed in the server at a given moment. If throttling is enabled at
        service level, it is the maximum requests for that particular
        service. In the case of operation level, it is the maximum requests
        for that particular operation.</td>
    </tr>
    <tr>
      <td>Range</td>
      <td>The IP address range or the domain is restricted from accessing the
        service. Requests from such clients will be restricted based on the
        specified values. </td>
    </tr>
    <tr>
      <td>Type</td>
      <td>This indicates the type of Range. It can be IP or DOMAIN. It should
        be IP if the range is given as a single IP address or a range of IP
        addresses (e.g., 10.100.1.30-10.100.1.60). It should be DOMAIN if the
        range is given as as a domain (e.g., *.wso2.com). If you specify
        configurations types of both IP and DOMAIN, first priority will be
        given to DOMAIN level configurations.</td>
    </tr>
    <tr>
      <td>Access</td>
      <td>If this is set to Allow, no restriction is applied for that range
        and all requests are allowed to go in as they come in. If it is Deny,
        access is completely denied for that range. When the Access is set to
        Allow or Deny, MRC, UT and PTP parameters are not necessary and t he
        said fields are de-activated. If it is Control, then the specified
        constraints are applied for that particular range. </td>
    </tr>
  </tbody>
</table>

Access constraints are divided into the following three parameters. 
<dl>
</dl>
<ul>
  <li><dl>
      <dt><strong>Maximum Request Count (MRC)</strong> </dt>
        <dd>If Allow Access is set to Control, it will be the maximum number
          of requests that are served within the time interval specified by
          the Unit Time parameter.</dd>
    </dl>
  </li>
  <li><dl>
      <dt><strong>Unit Time (UT)</strong> - </dt>
        <dd>The time period in milliseconds during which the maximum requests
          served. This is the number specified by the Maximum Request
          Count.The throttle starts counting the number of units from the
          moment it is enabled and the number of requests served within that
          period.</dd>
    </dl>
  </li>
  <li><dl>
      <dt><strong>Prohibit Time Period (PTP)</strong></dt>
        <dd>If the maximum request count is achieved before the unit time,
          this is the period during which no more requests are allowed to go
          in. By setting this value, the unit time slot is altered.</dd>
    </dl>
  </li>
</ul>

<p></p>

<p>Example :</p>

<p>MRC = 50, UT = 50000, PTP = 5000 </p>

<p>If 50 requests are arrived within 35000ms (35s) in a particular time
period, no more requests are taken in for another 5000ms (5s = PTP). This
time, the UT is altered to 35000ms + 5000ms = 40000ms (40s) </p>
</body></html>
